import{u as D,k as T,r as l,j as e,F as a,b as h,B as C,a as v,C as i,ay as V,az as B}from"./index-BmJdQGgB.js";import{v as G}from"./videosProductController-D90K6V0-.js";import{v as k}from"./videoCategoriesController-DQmkDw9N.js";import{P as R}from"./PageBreadcrumb-CQuiEbQ2.js";import{A}from"./Alert-DZdQ-6eB.js";import"./hook-BtDtdhSv.js";import"./extends-CF3RwP-h.js";import"./Anchor-BiqR9obF.js";const E=({show:o,message:u,type:t,onClose:d})=>o?e.jsx(A,{variant:t,onClose:d,dismissible:!0,className:"position-fixed top-0 end-0 m-3",style:{zIndex:9999},children:u}):null,U=({title:o})=>(l.useEffect(()=>{document.title=o},[o]),null),y=new G,q=new B,z=new k,X=()=>{const{videoId:o}=D(),u=T(),[t,d]=l.useState({title:"",courseId:"",categoryId:"",duration:"",order:1,access:"Free",description:"",status:!1,url:"",file:null}),[b,w]=l.useState([]),[I,m]=l.useState([]),[N,x]=l.useState({show:!1,message:"",type:"success"});l.useEffect(()=>{(async()=>{try{const s=await y.getVideoProductById(o);if(s!=null&&s.data){const n=s.data,j=n.status==="Active";d(g=>({...g,...n,status:j})),n.courseId&&f(n.courseId)}}catch(s){console.error("Failed to fetch video details:",s),p("Kh√¥ng th·ªÉ t·∫£i d·ªØ li·ªáu video!","danger")}})()},[o]),l.useEffect(()=>{(async()=>{try{const s=await q.getCourses();s!=null&&s.data&&w(s.data.data||[])}catch(s){console.error("Failed to fetch courses:",s)}})()},[]);const f=async r=>{var s;try{const n=await z.getCategories({courseId:r});m(((s=n==null?void 0:n.data)==null?void 0:s.data)||[])}catch(n){console.error("Failed to fetch categories:",n),m([])}},c=r=>{const{name:s,value:n,type:j,checked:g}=r.target;d(S=>({...S,[s]:j==="switch"?g:n}))},F=r=>{const s=r.target.value;d(n=>({...n,courseId:s,categoryId:""})),s?f(s):m([])},L=r=>{const s=r.target.files[0];s&&d(n=>({...n,file:s,url:URL.createObjectURL(s)}))},P=async r=>{r.preventDefault();try{const s=new FormData;s.append("title",t.title),s.append("courseId",t.courseId),s.append("categoryId",t.categoryId),s.append("duration",t.duration),s.append("order",t.order),s.append("access",t.access),s.append("description",t.description),s.append("status",t.status?"Active":"Inactive"),t.file&&s.append("url",t.file,t.file.name),await y.updateVideoProduct(o,s),p("D·ªØ li·ªáu ƒë√£ ƒë∆∞·ª£c l∆∞u th√†nh c√¥ng!","success")}catch(s){console.error("Failed to save data:",s),p("L∆∞u d·ªØ li·ªáu th·∫•t b·∫°i!","danger")}},p=(r,s="success")=>{x({show:!0,message:r,type:s}),setTimeout(()=>x({show:!1,message:"",type:"success"}),3e3)};return e.jsxs(e.Fragment,{children:[e.jsx(R,{subName:"Pages",title:"Ch·ªânh s·ª≠a chi ti·∫øt videos"}),e.jsx(U,{title:`Ch·ªânh s·ª≠a: ${t.title||"Video"}`}),e.jsx(E,{...N,onClose:()=>x(r=>({...r,show:!1}))}),e.jsx(a,{onSubmit:P,children:e.jsxs(h,{children:[e.jsxs(h.Header,{className:"d-flex justify-content-between align-items-center bg-light p-3",children:[e.jsxs("h4",{className:"card-title mb-0",children:["Th√¥ng tin Video: ",e.jsx("span",{className:"text-primary",children:t.title})]}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx(C,{variant:"secondary",onClick:()=>u(-1),children:"Quay l·∫°i"}),e.jsx(C,{variant:"primary",type:"submit",children:"L∆∞u thay ƒë·ªïi"})]})]}),e.jsx(h.Body,{children:e.jsxs(v,{className:"g-4",children:[e.jsxs(i,{lg:5,children:[e.jsx("h5",{className:"mb-3",children:"Xem tr∆∞·ªõc Video"}),e.jsx(h,{className:"shadow-sm",children:e.jsx(h.Body,{className:"p-2",children:t.url?e.jsx("video",{src:t.url.startsWith("blob:")?t.url:`${V}/uploads/videos/${t.url}`,controls:!0,width:"100%",style:{maxHeight:"400px",borderRadius:"8px",backgroundColor:"#000"}}):e.jsxs("div",{className:"d-flex flex-column align-items-center justify-content-center bg-light text-muted",style:{height:"300px",borderRadius:"8px"},children:[e.jsx("span",{style:{fontSize:"4rem"},children:"üé¨"}),e.jsx("p",{className:"mt-2",children:"Kh√¥ng c√≥ video ƒë·ªÉ hi·ªÉn th·ªã"})]})})}),e.jsxs(a.Group,{controlId:"videoUpload",className:"mt-3",children:[e.jsx(a.Label,{children:"T·∫£i l√™n video m·ªõi (thay th·∫ø)"}),e.jsx(a.Control,{type:"file",accept:"video/*",onChange:L})]})]}),e.jsxs(i,{lg:7,children:[e.jsx("h5",{className:"mb-3",children:"Th√¥ng tin chi ti·∫øt"}),e.jsxs(v,{className:"g-3",children:[e.jsx(i,{md:12,children:e.jsxs(a.Group,{children:[e.jsx(a.Label,{children:"Ti√™u ƒë·ªÅ Video"}),e.jsx(a.Control,{required:!0,type:"text",name:"title",value:t.title,onChange:c})]})}),e.jsx(i,{md:6,children:e.jsxs(a.Group,{children:[e.jsx(a.Label,{children:"Thu·ªôc Kh√≥a h·ªçc"}),e.jsxs(a.Select,{required:!0,name:"courseId",value:t.courseId,onChange:F,children:[e.jsx("option",{value:"",children:"Ch·ªçn kh√≥a h·ªçc..."}),b.map(r=>e.jsx("option",{value:r.id,children:r.title},r.id))]})]})}),e.jsx(i,{md:6,children:e.jsxs(a.Group,{children:[e.jsx(a.Label,{children:"Thu·ªôc Danh m·ª•c"}),e.jsxs(a.Select,{required:!0,name:"categoryId",value:t.categoryId,onChange:c,disabled:!t.courseId,children:[e.jsx("option",{value:"",children:"Ch·ªçn danh m·ª•c..."}),I.map(r=>e.jsx("option",{value:r.id,children:r.title},r.id))]})]})}),e.jsx(i,{md:4,children:e.jsxs(a.Group,{children:[e.jsx(a.Label,{children:"Th·ªùi l∆∞·ª£ng (gi√¢y)"}),e.jsx(a.Control,{type:"number",name:"duration",value:t.duration,onChange:c})]})}),e.jsx(i,{md:4,children:e.jsxs(a.Group,{children:[e.jsx(a.Label,{children:"S·ªë th·ª© t·ª±"}),e.jsx(a.Control,{type:"number",name:"order",value:t.order,onChange:c,min:1})]})}),e.jsx(i,{md:4,children:e.jsxs(a.Group,{children:[e.jsx(a.Label,{children:"Quy·ªÅn truy c·∫≠p"}),e.jsxs(a.Select,{name:"access",value:t.access,onChange:c,children:[e.jsx("option",{value:"Free",children:"Free"}),e.jsx("option",{value:"Premium",children:"Premium"})]})]})}),e.jsx(i,{md:12,children:e.jsxs(a.Group,{children:[e.jsx(a.Label,{children:"M√¥ t·∫£ ng·∫Øn"}),e.jsx(a.Control,{as:"textarea",rows:4,name:"description",value:t.description||"",onChange:c})]})}),e.jsx(i,{md:12,children:e.jsx(a.Check,{type:"switch",id:"status-switch",label:"Tr·∫°ng th√°i ho·∫°t ƒë·ªông",name:"status",checked:t.status,onChange:c})})]})]})]})})]})})]})};export{X as default};
